<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kyle McFatter</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils"></script>
</head>
<body>
    <nav>
        <ul>
            <li><a href="#section1">Home</a></li>
            <li><a href="#section2">Experience</a></li>
            <li><a href="#section3">Education</a></li>
            <li><a href="#section4">Projects</a></li>
            <li><a href="#section5">LeetCode</a></li>
            <li><a href="#section6">ASL Predictor</a></li>
        </ul>
    </nav>
    <main>
        <section id="section1" class="snap-section">
            <h2>Kyle McFatter</h2>
            <img src="imgs/kyleCutout.png" alt="Kyle McFatter">
            <p>Full Stack Developer</p>
        </section>

        <section id="section2" class="snap-section">
            <h2>Professional Experience</h2>
            <div class="business-cards">
                <!-- Card 1: Kaon Interactive -->
                <div class="card kaon-card">
                    <div class="card-inner">
                        <div class="card-front">
                            <h3>Kyle McFatter</h3>
                            <p>Front-End Development Intern</p>
                            <img src="imgs/kaonlogo.png" alt="Kaon Logo">
                        </div>
                        <div class="card-back">
                            <p>Front-End Development Intern at Kaon Interactive from June 2023 to August 2023</p>
                            <p>Maynard, MA</p>
                            <p>Designed and implemented three-dimensional immersive web applications for clientele</p>
                            <p>Boosted sales and marketing value for third parties by developing in-depth front-end applications using tools such as ReactJS</p>
                        </div>
                    </div>
                </div>

                <!-- Card 2: Citizens -->
                <div class="card citizens-card">
                    <div class="card-inner">
                        <div class="card-front">
                            <h3>Kyle McFatter</h3>
                            <p>UX Development Intern</p>
                            <img src="imgs/citizensLogo.png" alt="Citizens Logo">
                        </div>
                        <div class="card-back">
                            <p>User Experience Development Intern at Citizens from June 2022 to August 2022</p>
                            <p>Westwood, MA</p>
                            <p>Designed, modified, developed, and implemented technology solutions, focusing on front-end web and/or mobile development</p>
                            <p>Tested and explored next-generation technologies for potential inclusion in future products</p>
                            <p>Participated in code reviews of colleague work going to applications supporting over 10 million logins a month</p>
                            <p>Demonstrated solutions to senior leaders</p>
                        </div>
                    </div>
                </div>

                <!-- Card 3: CodaKid -->
                <div class="card codakid-card">
                    <div class="card-inner">
                        <div class="card-front">
                            <h3>Kyle McFatter</h3>
                            <p>Programming Instructor</p>
                            <img src="imgs/codakidLogo.jpeg" alt="CodaKid Logo">
                        </div>
                        <div class="card-back">
                            <p>Programming Instructor at CodaKid from June 2021 to August 2021</p>
                            <p>Scottsdale, AZ</p>
                            <p>Introduced students K-12 to foundational concepts of computer science</p>
                            <p>Created lesson plans for each individual student according to their respective goals and abilities</p>
                        </div>
                    </div>
                </div>

                <!-- Card 4: WPI -->
                <div class="card wpi-card">
                    <div class="card-inner">
                        <div class="card-front">
                            <h3>Kyle McFatter</h3>
                            <p>Teaching Assistant</p>
                            <img src="imgs/wpi.jpeg" alt="WPI Logo">
                        </div>
                        <div class="card-back">
                            <p>Department of Computer Science Teaching Assistant at Worcester Polytechnic Institute</p>
                            <p>Provided assistance to students in understanding course material</p>
                            <p>Assisted professors with grading and managing coursework</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="section3" class="snap-section">
            <h2>Education</h2>
            <div class="education-detail">
                <p><strong>Master's of Science from Worcester Polytechnic Institute</strong><br>
                Received in December of 2023 with a 3.80 GPA.</p>
                <p><strong>Bachelor's of Science from Worcester Polytechnic Institute</strong><br>
                Received in May of 2023 with a 3.85 GPA.</p>
            </div>
        </section>

        <section id="section4" class="snap-section">
            <h2>Personal Projects</h2>
            <div class="video-container">
                <div class="video-item">
                    <h3>ASL Recognition</h3>
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/RuUlaJyyrJY" frameborder="0" allowfullscreen></iframe>
                </div>
                <div class="video-item">
                    <h3>Camera Sudoku Solver</h3>
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/7GydCBg6ICw" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
        </section>

        <section id="section5" class="snap-section">
            <h2>LeetCode</h2>
            <div class="video-container">
                <div class="video-item">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/videoseries?list=PLh_n5QWXYsevYCLe2hQp-7h-ab4e5W6g8" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
        </section>

        <!-- New ASL Predictor Section -->
        <section id="section6" class="snap-section">
            <h2>ASL Letter Predictor</h2>
            <h3 id="detected-letter">Detected Letter: </h3>
            <div class="asl-container">
                <!-- Combined video feed with canvas for drawing landmarks -->
                <div class="camera-wrapper">
                    <canvas id="outputCanvas"></canvas> <!-- Only one canvas used -->
                </div>
                <!-- ASL chart image -->
                <div class="chart-wrapper">
                    <img src="imgs/asl_chart.jpg" alt="ASL Alphabet Chart" class="asl-chart">
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>Contact: mcfatterkyle@gmail.com | Phone: (781) 375-7318</p>
        <div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
            <a href="https://www.linkedin.com/in/kyle-mcfatter" target="_blank">
                <img src="imgs/linkedIn.png" alt="LinkedIn" style="width: 30px; height: 30px;">
            </a>
            <a href="https://github.com/KyleWynnM" target="_blank">
                <img src="imgs/github.png" alt="GitHub" style="width: 30px; height: 30px;">
            </a>
        </div>
    </footer>

    <script>
        // Define global variables
        let canvasElement = document.getElementById('outputCanvas');
        let canvasCtx = canvasElement.getContext('2d');
        let videoElement;
        let model;
        let previousDetectedLetter = null; // Track previous letter to avoid repeating

        // Function to load the TensorFlow.js model
        async function loadModel() {
            model = await tf.loadLayersModel('./asl_hand_model5/model.json'); // Adjust the path to your model
            console.log("Model loaded successfully.");
        }

        // Function to update detected letter in the DOM
        function updateDetectedLetter(letter) {
            const detectedLetterElement = document.getElementById('detected-letter');
            if (detectedLetterElement) {
                detectedLetterElement.textContent = `Detected Letter: ${letter}`;
            } else {
                console.log("Detected letter element not found in the DOM.");
            }
        }

        // Function to preprocess hand landmarks into ratios
        function calculateScaledRatios(landmarks) {
            const xs = landmarks.map(landmark => landmark.x);
            const ys = landmarks.map(landmark => landmark.y);
            const zs = landmarks.map(landmark => landmark.z);
            const min_x = Math.min(...xs), max_x = Math.max(...xs);
            const min_y = Math.min(...ys), max_y = Math.max(...ys);
            const min_z = Math.min(...zs), max_z = Math.max(...zs);

            const scale_x = max_x - min_x;
            const scale_y = max_y - min_y;
            const scale_z = max_z - min_z;

            let ratios = [];
            for (let i = 0; i < landmarks.length; i++) {
                for (let j = i + 1; j < landmarks.length; j++) {
                    const ratio_x = (landmarks[i].x - min_x) / scale_x;
                    const ratio_y = (landmarks[i].y - min_y) / scale_y;
                    const ratio_z = (landmarks[i].z - min_z) / scale_z;
                    ratios.push(ratio_x, ratio_y, ratio_z);
                }
            }
            return ratios;
        }

        // Function to make predictions with the model
        async function predictGesture(landmarks) {
            if (!model) {
                console.log("Model is not loaded yet!");
                return null;
            }

            const ratios = calculateScaledRatios(landmarks);
            const inputTensor = tf.tensor2d([ratios]);
            const prediction = await model.predict(inputTensor).data();
            const maxIndex = prediction.indexOf(Math.max(...prediction));

            const labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            return labels[maxIndex];
        }

        // Initialize MediaPipe Hands and camera feed
        async function setupCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            videoElement = document.createElement('video');
            videoElement.srcObject = stream;
            videoElement.play();

            videoElement.addEventListener('loadedmetadata', () => {
                // Setup canvas dimensions based on video size
                canvasElement.width = videoElement.videoWidth;
                canvasElement.height = videoElement.videoHeight;
            });

            return new Promise((resolve) => {
                videoElement.onloadeddata = () => {
                    resolve(videoElement);
                };
            });
        }

        // Function to process hand landmarks and update lesson page
        async function onResults(results) {
            canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
            canvasCtx.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height); // Draw video frame onto canvas

            if (results.multiHandLandmarks) {
                for (const landmarks of results.multiHandLandmarks) {
                    // Draw hand landmarks directly on the webcam feed
                    drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS, { color: '#e598ff', lineWidth: 2 });
                    drawLandmarks(canvasCtx, landmarks, { color: '#ca00ff', lineWidth: 2, radius: 3 });

                    // Predict the letter
                    const detectedLetter = await predictGesture(landmarks);
                    console.log("Detected Letter:", detectedLetter);

                    if (detectedLetter) {
                        // Update the detected letter in the DOM
                        updateDetectedLetter(detectedLetter);

                        // Update the previous detected letter
                        previousDetectedLetter = detectedLetter;
                    }
                }
            }
        }

        // Load the model and start the camera feed when the page is fully loaded
        document.addEventListener('DOMContentLoaded', async () => {
            await loadModel();
            const video = await setupCamera();

            const hands = new Hands({
                locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`,
            });

            hands.setOptions({
                maxNumHands: 1,
                modelComplexity: 1,
                minDetectionConfidence: 0.5,
                minTrackingConfidence: 0.5
            });

            hands.onResults(onResults);

            const camera = new Camera(video, {
                onFrame: async () => {
                    await hands.send({ image: video });
                },
                width: 640,
                height: 480
            });
            camera.start();
        });
    </script>
</body>
</html>
